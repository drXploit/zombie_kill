<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_flare</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Flare creation
global.instances++;

inAir = true;
life = room_speed*5;
m = 1; //multiplier

mX = mouse_x;
mY = mouse_y;

// canDraw limits FPS to room_speed
canDraw = true;

direction = point_direction(obj_player.x,obj_player.y,mouse_x,mouse_y);

motion_set(direction,9);

gravity = 0.07;
friction = 0.05;

alarm[0] = room_speed*5;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Destroy
global.instances--;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Destroy the flare

//
// Draw an explosion "stain"
if (instance_exists(obj_blood_control))
{
    surface_set_target(obj_blood_control.surf_blood);
    draw_sprite_ext(spr_char,0,x,y,image_xscale/2,image_yscale/2,random(359),c_dkgray,0.6);
    surface_reset_target();
}

instance_destroy();

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Behave differently "on the ground"

inAir = false;

alarm[1] = life;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Step

if (!inAir) 
{
    m = 5;
    friction += .003;
}
if (distance_to_point(mX,mY) &lt; 20) inAir = false;

if (hspeed != 0)
{
    if !place_free(x+hspeed, y)
    {
        if (hspeed &gt;0) move_contact_solid(0, hspeed);
        if (hspeed &lt;0) move_contact_solid(180, -hspeed);
        hspeed = -hspeed;
        inAir = false;
    }

}
if (vspeed != 0)
{
    if !place_free(x+hspeed, y+vspeed)
    {
        if (vspeed &gt;0) move_contact_solid(270, vspeed);
        if (vspeed &lt;0) move_contact_solid(90, -vspeed);
        vspeed = 0;
        inAir = false;
    }
    if (y &gt; obj_player.y &amp;&amp; !inAir) friction += 0.01;
}

if (ystart &lt; y) 
{
    if (distance_to_point(xstart,ystart) &gt; 200) inAir = false;
}
if (ystart &gt; y)
{
    if (hspeed &lt; 0)
        if (xstart-x &gt; 200) inAir = false;

    if (hspeed &gt; 0)
        if (x-xstart &gt; 200) inAir = false;

}

if (friction &gt; 1) friction = 1;




/// Draw flare effect

if (!inAir) // limiting flare fps to 60
{
    draw_set_alpha(choose(0.1, 0.3, 0.2));
    draw_set_color(choose(c_red,c_white,c_maroon));
//    draw_set_alpha(0.2);
    draw_circle(x,y,choose(10,15,6,8,13),false);
//    effect_create_above(ef_firework, x, y, choose(0.4,0.6,0.8), choose(c_red,c_white,c_maroon));
//    effect_create_above(ef_flare, x, y, choose(0.6*m,0.8*m), c_maroon);
//    effect_create_above(ef_flare, x, y, choose(1.4*m,1.6*m,1.8*m), c_white);

//    draw_set_alpha(1);    

}
if (inAir)
{
//    effect_create_below(ef_smokeup, x, y, 0.1, c_dkgray);
    if (image_xscale &lt; 0)
    {
        image_angle += 8;
        if (image_angle &gt; 359) image_angle = 0;

    }
    else if (image_xscale &gt; 0)
    {
        image_angle -= 8;
        if (image_angle &lt;= 0) image_angle = 359;
    }
    
    if (image_angle &gt;= 360)
        image_angle = 0;

}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Destroy
instance_destroy();

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw flare effect

    draw_self();


</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>3,3</point>
    <point>3,3</point>
  </PhysicsShapePoints>
</object>
